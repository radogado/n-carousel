.n-carousel--content {
	
	display: flex;
	will-change: scroll;
	box-sizing: content-box;
	padding: var(--peek-y, 0) var(--peek-x, 0);
	
	@media (prefers-reduced-motion: reduce) {
	
		transition: none;
	
	}
	
	&:not([data-sliding]) {

		scroll-snap-type: both mandatory;
		
		> * {
			
			scroll-snap-align: center;
			
		}
	
	}

	scrollbar-width: none; /* Firefox */

	&::-webkit-scrollbar {
	
		display: none;
	
	}
 
	> * {

		flex: 1 0 auto;
		width: 100%;
		box-sizing: border-box;
// 		transition: height .2s ease-in-out;

	}

	&[data-sliding] {

		pointer-events: none;
		
	}
	
	&, 
	
	
/*
	> :not([data-active]):not(:last-child), &[data-sliding] > *:not(:last-child) {
			
		overflow: hidden;

	}
*/

	> :not([data-active]):last-child, &[data-sliding] > *:last-child {
			
	    -webkit-mask: linear-gradient(0, #000, #000);
	    mask: linear-gradient(0, #000, #000);

	}
	
}

:not(.n-carousel__vertical) > .n-carousel--content {
	
	overflow-x: auto;

	&:after {

	    content: '';
        flex-shrink: 0;
// 	        padding-inline-end: inherit;
	    width: var(--peek-x, 0); // Fixed value option


	}

	&:not(.n-carousel__auto) > * {
		
		overflow: auto;
		
	}

}

.n-carousel__vertical > .n-carousel--content {
	
	overflow-y: auto;
	flex-direction: column;
	
	> * {
		
// 			height: var(--height, inherit); // Fallback not working in Safari
		height: inherit; // Fallback not working in Safari
		overflow: hidden;

	}
	

}

// Chrome/FF can't scrollTo while scroll snapping is active. Safari can, but it can't toggle snapping programmatically without resetting scroll offset.

_::-webkit-full-page-media, _:future, :root .n-carousel--content[data-sliding] {

	scroll-snap-type: both mandatory;
	
}

_::-webkit-full-page-media, _:future, :root .n-carousel--content[data-sliding] > * {

	scroll-snap-align: center;

}

// No snapping in Safari when RTL (?!) To do: polyfill

_::-webkit-full-page-media, _:future, :root [dir="rtl"] :not(.n-carousel__vertical) > .n-carousel--content {

	scroll-snap-type: none;
	
}

// Because macOS-only Safari can't swipe backwards when pointer events are re-enabled.

@supports not (-webkit-touch-callout: none) {

	_::-webkit-full-page-media, _:future, :root .n-carousel--content[data-sliding] {
	
		pointer-events: all;
	
	}

}

.n-carousel--index, .n-carousel--previous, .n-carousel--next {

	 button {

		-webkit-touch-callout: none;
	    -webkit-user-select: none;
	    user-select: none;		
		all: revert;
		border: none;
		background: #eee;
		min-width: 42px;
		min-height: 42px;
		border-radius: 42px;
		cursor: pointer;
		margin: .25em;
	    font: inherit;
	    text-align: center;
		
		&[disabled] {
			
			opacity: .5;
	
		}
	
	}

}

// LTR & RTL chevrons – but what about RTL defined by CSS 'direction' instead of the 'dir' attribute?

.n-carousel--previous, [dir="rtl"] .n-carousel--next {

	button:before {
		 
		 content: '⬅';
	
	}

}

.n-carousel--next, [dir="rtl"] .n-carousel--previous {

	button:before {
		 
		 content: '➡';
	
	}

}

.n-carousel__vertical > .n-carousel--next, .n-carousel__vertical > .n-carousel--previous {
	
	button:before {
		
		content: '';

	}	
	
}

.n-carousel__vertical > .n-carousel--content.n-carousel__auto {
	
	overflow: hidden;
	overflow-y: auto;


}

/* .n-carousel[data-ready] > .n-carousel__auto:not(.n-carousel__vertical) > :not([data-active]), */ .n-carousel:not([data-ready]) > .n-carousel__auto > :not(:first-child) {
	
	height: 0;
	
}

.n-carousel:not([data-ready]) > .n-carousel--content > :not([data-active]):not(:last-child) {
	
	overflow: auto;
	
}

.n-carousel {
	
	display: grid;
	grid-template: 1fr auto 1fr/auto 1fr auto 1fr auto;

    grid-template-areas:
        "a1 		a2 a2 		a2 	a3"
        "previous 	a2 a2 		a2 	next"
        "a4 		a4 index 	a5 	a5";
	
	> .n-carousel--content { // To do: support intermediate container, while not affecting nested carousels
		
	    grid-row: 1/-1;
	    grid-column: 1/-1;
    		
	}
	
	> :not(.n-carousel--content) {
		
	    z-index: 1;
    		
	}
	
	> .n-carousel--previous {
		
		grid-row: 2/3;
		grid-column: 1/2;
    		
	}
    
	> .n-carousel--next {

	    grid-row: 2/3;
	    grid-column: -2/-1;

	}

	> .n-carousel--index {

		grid-row: -2/-1;
	    grid-column: 3/4;
		align-self: end;
    
	}
	
	&.n-carousel__controls-top {
		
		> .n-carousel--index {
	
			grid-row: 1/2;
			align-self: start;
	    
		}
	
	}

	&.n-carousel__controls-outside {
		
		grid-template-rows: 1fr auto;
	
		> .n-carousel--content {
			
			grid-row: 1/-2;
			grid-column: 2/-2;
    			
		}
		
		> .n-carousel--previous, > .n-carousel--next {
			
			grid-row: 1/2;
			align-self: center;
			    
		}
	
		&.n-carousel__controls-top > {
			
			.n-carousel--content, .n-carousel--previous, .n-carousel--next {
				
				grid-row: 2/3;
				    
			}
	
		}

	}
	
	&.n-carousel__vertical {
		
// 	 	grid-template: 1fr auto 1fr/auto 1fr auto 1fr 50px; // Where 50px should be the width of the index
		
		> .n-carousel--index {
	
			grid-row: 1/-1;
		    grid-column: 1/2;
	        align-self: center;
		    display: flex;
		    flex-direction: column;
    	    
		}
		
		&.n-carousel__controls-right > .n-carousel--index {
	
		    grid-column: -1/-2;
    	    
		}
		
		> .n-carousel--previous {
			
		    grid-row: 1/2;
		    grid-column: 3/4;
	        align-self: start;
    			
		}
		
		> .n-carousel--next {

		    grid-row: -1/-2;
		    grid-column: 3/4;
		    align-self: end;
        			
		}
		
	}

	&.n-carousel__vertical.n-carousel__controls-outside {
		
	    grid-template-rows: auto 1fr auto;
		
		> .n-carousel--content {
		
			grid-row: 2/-2;
	
		}		
	
	}
	
	&.n-carousel__tabs {
		
		> .n-carousel--index {
			
			display: flex;
			flex-wrap: wrap;
			
			button {
				
				border-radius: 0;
				margin: 0;
				
				&:focus {
					
					z-index: 0;

				}

			}

		}
		
	}
	
}

@-moz-document url-prefix() {

	.n-carousel__vertical > .n-carousel--content { // FF doesn't respect the end padding of the vertical carousel. Can't use this for all, bc it breaks Safari 
		
		display: block;

		> :last-child {
			
			margin-block-end: var(--peek-y, 0);

		}

	}
	
}
