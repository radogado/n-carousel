{"version":3,"file":"n-carousel.min.js","names":["ceilingWidth","el","Math","ceil","parseFloat","getComputedStyle","width","ceilingHeight","height","focusableElements","isChrome","navigator","userAgent","match","isSafari","isEndless","children","length","parentElement","classList","contains","isFullScreen","document","webkitFullscreenElement","fullscreenElement","isModal","closest","isVertical","matches","isAutoHeight","indexControls","index","controls_by_class","querySelectorAll","scrollEndAction","carousel","target","abs","round","scrollTop","offsetHeight","paddingBlockStart","paddingBlockEnd","scrollLeft","offsetWidth","paddingInlineStart","paddingInlineEnd","slide","parentNode","sliding","dataset","next","parseInt","indexOf","timeout","observersOff","setTimeout","new_height","old_height","offset_y","lastScrollX","lastScrollY","scroll_offset","style","computed_max_height","maxHeight","max_height","min","nextSlideHeight","scrollTo","window","requestAnimationFrame","scrollAnimate","then","updateCarousel","overflow","scrollHeight","getIndex","y","x","getIndexReal","active_slide","querySelector","hash_slide_index","location","hash","scrolledAncestor","isRTL","direction","toggleFullScreen","restoreScroll","nuiAncestors","forEach","nuiScrollX","nuiScrollY","removeEventListener","togglingFullScreen","exitFullscreen","webkitExitFullscreen","display","updateExitFullScreen","e","slideTo","addEventListener","arr","a","push","scrolledAncestors","requestFullscreen","webkitRequestFullscreen","scrollStartX","getScroll","scrollX","scrollY","firstFocusableElement","focusableContent","lastFocusableElement","focusHandler","key","keyCode","shiftKey","activeElement","focus","preventDefault","trapFocus","modal","off","getControl","control","detached_control","id","closestCarousel","related_by_id","for","getElementById","distanceX","distanceY","Promise","resolve","reject","wrapper","nextSlideInstant","ready","matchMedia","scroll_changing","setProperty","startx","starty","starth","distanceH","duration","start","draw","now","n","val","cos","PI","timeStamp","forced","saved_x","saved_y","firstElementChild","active_index","old_active_slide","observersOn","removeAttribute","setAttribute","active_index_real","restoreDisplacedSlides","el2","append","first","prepend","lastElementChild","last","max","updateScroll","scroll_x","scroll_y","paddingY","visibility","previously_active","nCarouselNav","inert","current","test","offsetX","offsetY","clearTimeout","nCarouselTimeout","old_scroll_left","old_scroll_top","paddingX","top","left","behavior","slideNext","slidePrevious","new_offset","carouselKeys","includes","slidePreviousEvent","slideNextEvent","slideIndexEvent","href","ctrlKey","metaKey","new_index","old_index","openModal","body","frozen","closeModalOnBodyClick","overlay","closeModal","toggleModal","remove","add","autoHeightObserver","ResizeObserver","entries","removeProperty","updateSubpixels","padding","getBoundingClientRect","offset","height_minus_index","observe","unobserve","subpixel_observer","mutation_observer","attributes","attributeFilter","observerStarted","updateObserver","doUpdate","current_height","getPropertyValue","MutationObserver","mutations","mutation","setIndexWidth","position","init","host","previous","close_modal","full_screen","content","onclick","xx","yy","fullScreenEvent","onwebkitfullscreenchange","onfullscreenchange","hashed_slide","auto_delay","interval","carouselTimeout","rect","bottom","innerHeight","documentElement","right","innerWidth","isElementInViewport","platform","nCarouselUpdate","loaded","img","complete","nCarouselInit","modal_carousel","doInit","nui","registerComponent","readyState"],"sources":["n-carousel.js"],"mappings":"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","sourcesContent":["// import './node_modules/n-modal/n-modal.js';\nimport './scrollyfills.module.js'; // scrollend event polyfill\n(function() {\n  const ceilingWidth = el => Math.ceil(parseFloat(getComputedStyle(el).width));\n  const ceilingHeight = el => Math.ceil(parseFloat(getComputedStyle(el).height));\n  const focusableElements = 'button, [href], input, select, textarea, details, summary, video, [tabindex]:not([tabindex=\"-1\"])';\n  // const _focusableElementsString =  'a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),details,summary,iframe,object,embed,[contenteditable]';\n  function isElementInViewport(el) {\n    let rect = el.getBoundingClientRect();\n    return (rect.top >= 0 && rect.left >= 0 && rect.bottom <= (window.innerHeight || document.documentElement.offsetHeight) /* or $(window).height() */ && rect.right <= (window.innerWidth || document.documentElement.offsetWidth) /* or $(window).width() */ );\n  }\n  const default_duration = 500;\n  const default_interval = 4000;\n  const isChrome = !!navigator.userAgent.match(\"Chrome\");\n  const isSafari = navigator.userAgent.match(/Safari/) && !isChrome;\n  const isEndless = el => el.children.length > 2 && el.parentElement.classList.contains(\"n-carousel--endless\");\n  const isFullScreen = () => { return !!(document.webkitFullscreenElement || document.fullscreenElement) };\n  const isModal = el => { return el.closest(\".n-carousel\").classList.contains('n-carousel--overlay') };\n  const isVertical = el => el.closest(\".n-carousel\").matches(\".n-carousel--vertical\");\n  const isAutoHeight = el => el.closest(\".n-carousel\").matches(\".n-carousel--auto-height\");\n  const indexControls = index => {\n    let controls_by_class = index.querySelectorAll('.n-carousel__control');\n    return (controls_by_class.length > 0) ? controls_by_class : index.querySelectorAll('a, button');\n  }\n  const scrollEndAction = carousel => {\n    carousel = carousel.target || carousel;\n    // console.log('scroll end', carousel);\n    let index = Math.abs(Math.round(\n      (isVertical(carousel) ? carousel.scrollTop / (carousel.offsetHeight - parseFloat(getComputedStyle(carousel).paddingBlockStart) - parseFloat(getComputedStyle(carousel).paddingBlockEnd)) : carousel.scrollLeft / (carousel.offsetWidth - parseFloat(getComputedStyle(carousel).paddingInlineStart) - parseFloat(getComputedStyle(carousel).paddingInlineEnd))), 2));\n    // console.log('scroll end', index);\n    let slide = carousel.children[index];\n    if (!!carousel.parentNode.sliding || (carousel.dataset.next && parseInt(carousel.dataset.next) !== [...carousel.children].indexOf(slide))) {\n      return;\n    }\n    // console.log(index);\n    carousel.parentNode.dataset.sliding = true;\n    let timeout = 0;\n    delete carousel.dataset.next;\n    observersOff(carousel);\n    let x = carousel.scrollLeft;\n    let y = carousel.scrollTop;\n    let interval = 10; // Get rid of this magic number by timeout comparison with previous scroll offset\n    let timeout_function = () => {\n      // console.log(entry, entry.target, 'is intersecting at', entry.target.parentElement.scrollLeft, entry.target.parentElement.scrollTop);\n      // if (Math.abs(x - carousel.scrollLeft) >= 1) {\n      //   console.log('intersection continue', x, carousel.scrollLeft, y, carousel.scrollLeft);\n      //   clearTimeout(timeout);\n      //   timeout = setTimeout(timeout_function, interval);\n      //   return;\n      // }\n      // console.log('intersection ', x, carousel.scrollLeft, y, carousel.scrollLeft);\n      let index = [...carousel.children].indexOf(slide);\n      if (isAutoHeight(carousel)) {\n        let old_height = parseFloat(getComputedStyle(carousel).height);\n        let new_height;\n        let offset_y = 0;\n        let lastScrollX = carousel.scrollLeft;\n        let lastScrollY = carousel.scrollTop;\n        if (isVertical(carousel)) {\n          let scroll_offset = carousel.scrollTop;\n          slide.style.height = 'auto';\n          let computed_max_height = getComputedStyle(carousel).maxHeight;\n          let max_height = computed_max_height.match(/px/) ? Math.ceil(parseFloat(computed_max_height)) : 99999;\n          // new_height = Math.min(slide.scrollHeight, max_height);\n          new_height = Math.min(Math.ceil(parseFloat(getComputedStyle(slide).height)), max_height);\n          // new_height = slide.scrollHeight;\n          if (isModal(carousel) || isFullScreen()) {\n            old_height = new_height = carousel.offsetHeight;\n          }\n          slide.style.height = '';\n          carousel.scrollTop = scroll_offset;\n          offset_y = index * new_height - carousel.scrollTop;\n        } else {\n          new_height = nextSlideHeight(slide); // ?\n          // console.log(lastScrollX);\n          if (!!lastScrollX) { // Because RTL auto height landing on first slide creates an infinite intersection observer loop\n            scrollTo(carousel, lastScrollX, lastScrollY);\n          }\n        }\n        if (old_height === new_height) {\n          new_height = false;\n        }\n        // interSecObs.unobserve(slide);\n        window.requestAnimationFrame(() => {\n          scrollAnimate(carousel, 0, offset_y, new_height, old_height).then(() => {});\n        });\n      } else {\n        // console.log(carousel);\n        window.requestAnimationFrame(() => {\n          updateCarousel(carousel);\n        });\n      }\n    };\n    timeout = setTimeout(timeout_function, interval);\n  }\n  const hashNavigation = e => { // Hash navigation support\n    // console.log(e);\n    if (!!location.hash) {\n      let el = document.querySelector(location.hash);\n      let carousel = el?.parentNode;\n      if (!!carousel && carousel.classList.contains('n-carousel__content') && !carousel.parentNode.closest('.n-carousel__content')) {\n        let modal_carousel = document.querySelector('.n-carousel--overlay > .n-carousel__content');\n        if (modal_carousel && modal_carousel !== carousel) {\n          closeModal(modal_carousel);\n          // modal_carousel.parentNode.classList.remove('n-carousel--overlay');\n        }\n        if (carousel.parentNode.classList.contains('n-carousel--inline')) {\n          closeModal(carousel);\n          // carousel.parentNode.classList.add('n-carousel--overlay');\n        }\n        if (isSafari) { // Safari has already scrolled and needs to rewind it scroll position in order to animate it\n          scrollTo(carousel, carousel.offsetWidth * carousel.dataset.x, carousel.offsetHeight * carousel.dataset.y);\n        }\n        slideTo(carousel, [...carousel.children].indexOf(el));\n        window.nCarouselNav = [carousel, location.hash];\n      }\n    } else {\n      if (window.nCarouselNav) { // Previously navigated to a slide\n        let carousel = window.nCarouselNav[0];\n        delete window.nCarouselNav;\n        if (isSafari) { // Safari has already scrolled and needs to rewind it scroll position in order to animate it\n          scrollTo(carousel, carousel.offsetWidth * carousel.dataset.x, carousel.offsetHeight * carousel.dataset.y);\n        }\n        slideTo(carousel, [...carousel.children].indexOf(carousel.querySelector(':scope > :not([id])')));\n      }\n    }\n  };\n  const nextSlideHeight = el => {\n    el.style.height = 0;\n    el.style.overflow = \"auto\";\n    const height = el.scrollHeight; // Ceiling when subpixel\n    el.style.height = el.style.overflow = \"\";\n    return height;\n  };\n  // const scrollableAncestor = el => {\n  // \tel = el.parentNode;\n  // \twhile (el) {\n  // \t\tif (el.scrollHeight > el.offsetHeight || el.scrollWidth > el.offsetWidth) {\n  // \t\t\treturn el;\n  // \t\t} else {\n  // \t\t\tel = el.parentNode;\n  // \t\t}\n  // \t}\n  // \treturn false;\n  // };\n  const getIndex = el => 1 * (isVertical(el) ? el.dataset.y : el.dataset.x);\n  const getIndexReal = el => {\n    let active_slide = el.querySelector(':scope > [aria-current]');\n    if (active_slide) {\n      return [...el.children].indexOf(active_slide);\n    } else {\n      let hash_slide_index = (!!location.hash) ? [...el.children].indexOf(el.querySelector(`:scope > ${location.hash}`)) : 0;\n      return (hash_slide_index > -1) ? hash_slide_index : 0;\n    }\n    // return active_slide ? [...el.children].indexOf(active_slide) : (el.querySelector(`:scope > ${location.hash}`) || 0);\n  };\n  const scrolledAncestor = el => {\n    el = el.parentNode;\n    while (el) {\n      if (el.scrollTop !== 0 || el.scrollLeft !== 0) {\n        return el;\n      } else {\n        el = el.parentNode;\n      }\n    }\n    return false;\n  };\n  const scrolledAncestors = el => {\n    let arr = [];\n    let a = scrolledAncestor(el);\n    while (a && typeof a.scrollLeft !== \"undefined\" && (a.scrollTop !== 0 || a.scrollLeft !== 0)) {\n      arr.push(a);\n      a = scrolledAncestor(a);\n    }\n    return arr;\n  };\n  const isRTL = el => getComputedStyle(el).direction === \"rtl\";\n  const toggleFullScreen = el => {\n    el = el.closest(\".n-carousel\");\n    let carousel = el.querySelector(\":scope > .n-carousel__content\");\n    const restoreScroll = () => {\n      if (!isFullScreen()) {\n        el.nuiAncestors.forEach(el => {\n          window.requestAnimationFrame(() => {\n            el.scrollLeft = el.nuiScrollX;\n            el.scrollTop = el.nuiScrollY;\n            delete el.nuiScrollX;\n            delete el.nuiScrollY;\n          });\n        });\n        delete el.nuiAncestors;\n        el.removeEventListener(\"webkitfullscreenchange\", restoreScroll);\n      }\n    };\n    carousel.togglingFullScreen = true;\n    if (isFullScreen()) {\n      // Exit full screen\n      !!document.exitFullscreen ? document.exitFullscreen() : document.webkitExitFullscreen();\n      if (isSafari) {\n        // When exit finishes, update the carousel because on Safari 14, position is wrong or the slide is invisible\n        setTimeout(() => {\n          el.style.display = \"none\";\n          window.requestAnimationFrame(() => {\n            el.style.display = \"\";\n          });\n        }, 0);\n      }\n      if (isVertical(el) && isAutoHeight(el)) {\n        let updateExitFullScreen = e => {\n          setTimeout(() => {\n            let carousel = el.querySelector(\":scope > .n-carousel__content\");\n            // console.log(carousel);\n            // el.style.removeProperty('--height');\n            // carousel.style.height = '';\n            slideTo(carousel, parseInt(carousel.dataset.y));\n          }, 100);\n          el.removeEventListener('fullscreenchange', updateExitFullScreen);\n        };\n        el.addEventListener('fullscreenchange', updateExitFullScreen);\n      }\n    } else {\n      // Enter full screen\n      if (isSafari) {\n        el.nuiAncestors = scrolledAncestors(el);\n        el.nuiAncestors.forEach(el => {\n          el.nuiScrollX = el.scrollLeft;\n          el.nuiScrollY = el.scrollTop;\n        });\n        el.addEventListener(\"webkitfullscreenchange\", restoreScroll, false);\n      }!!el.requestFullscreen ? el.requestFullscreen() : el.webkitRequestFullscreen();\n    }\n  };\n  const scrollStartX = el => el.scrollLeft; // Get correct start scroll position for LTR and RTL\n  const scrollTo = (el, x, y) => {\n    el.scrollTo(isRTL(el) ? -1 * Math.abs(x) : x, y); // Scroll to correct scroll position for LTR and RTL\n  };\n  const getScroll = el => (el === window ? {\n    x: el.scrollX,\n    y: el.scrollY\n  } : {\n    x: scrollStartX(el),\n    y: el.scrollTop\n  });\n  let firstFocusableElement = null;\n  let focusableContent = null;\n  let lastFocusableElement = null;\n  const focusHandler = e => {\n    let isTabPressed = e.key === \"Tab\" || e.keyCode === 9;\n    if (!isTabPressed) {\n      return;\n    }\n    if (e.shiftKey) {\n      // if shift key pressed for shift + tab combination\n      if (document.activeElement === firstFocusableElement) {\n        lastFocusableElement.focus(); // add focus for the last focusable element\n        e.preventDefault();\n      }\n    } else {\n      // if tab key is pressed\n      if (document.activeElement === lastFocusableElement) {\n        // if focused has reached to last focusable element then focus first focusable element after pressing tab\n        firstFocusableElement.focus(); // add focus for the first focusable element\n        e.preventDefault();\n      }\n    }\n  }\n  const trapFocus = (modal, off = false) => {\n    // FROM: https://uxdesign.cc/how-to-trap-focus-inside-modal-to-make-it-ada-compliant-6a50f9a70700\n    // add all the elements inside modal which you want to make focusable\n    firstFocusableElement = modal.querySelectorAll(focusableElements)[0]; // get first element to be focused inside modal\n    focusableContent = modal.querySelectorAll(focusableElements);\n    lastFocusableElement = focusableContent[focusableContent.length - 1]; // get last element to be focused inside modal\n    if (off) {\n      modal.removeEventListener(\"keydown\", focusHandler);\n    } else {\n      modal.addEventListener(\"keydown\", focusHandler);\n      firstFocusableElement.focus();\n    }\n  };\n  const inOutSine = (n) => (1 - Math.cos(Math.PI * n)) / 2;\n  const paddingX = el => parseInt(getComputedStyle(el).paddingInlineStart) * 2;\n  const paddingY = el => parseInt(getComputedStyle(el).paddingBlockStart) * 2;\n  const getControl = (carousel, control) => {\n    let detached_control = document.querySelector(`${control}[data-for=\"${carousel.id}\"]`);\n    if (detached_control) {\n      return detached_control;\n    }\n    for (let el of carousel.children) {\n      if (el.matches(control)) {\n        return el;\n      }\n      if (!el.matches(\".n-carousel__content\") && el.querySelector(control)) {\n        return el.querySelector(control);\n      }\n    }\n  };\n  const closestCarousel = el => {\n    var related_by_id = el.closest('[class*=\"n-carousel\"]').dataset.for;\n    if (!!related_by_id) {\n      return document.getElementById(related_by_id).querySelector(\".n-carousel__content\");\n    } else {\n      return el.closest(\".n-carousel\").querySelector(\".n-carousel__content\");\n    }\n  };\n  const scrollAnimate = (el, distanceX, distanceY, new_height, old_height = false) => new Promise((resolve, reject) => {\n    // Thanks https://stackoverflow.com/posts/46604409/revisions\n    let wrapper = el.closest(\".n-carousel\");\n    if (!!wrapper.nextSlideInstant || !wrapper.dataset.ready || window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches || wrapper.matches(\".n-carousel--instant\")) {\n      scrollTo(el, getScroll(el).x + distanceX, getScroll(el).y + distanceY);\n      el.style.height = `${new_height}px`;\n      delete wrapper.nextSlideInstant;\n      updateCarousel(el);\n      resolve(el);\n      return;\n    }\n    observersOff(el);\n    let scroll_changing = true;\n    if (distanceX === 0 && distanceY === 0) {\n      scroll_changing = false;\n    }\n    if (!!new_height) {\n      el.style.height = `${old_height}px`;\n      if (isVertical(el) && isAutoHeight(el)) {\n        el.style.setProperty('--subpixel-compensation', 0);\n      }\n    } else {\n      if (!isVertical(el)) {\n        el.style.height = \"\";\n      }\n    }\n    var startx = getScroll(el).x;\n    var starty = getScroll(el).y;\n    var starth = parseInt(el.style.height);\n    var distanceH = new_height - starth;\n    var duration = parseFloat(el.parentNode.dataset.duration) * 1000 || default_duration;\n    var start = null;\n    var end = null;\n    let startAnim = (timeStamp) => {\n      start = timeStamp;\n      end = start + duration;\n      draw(timeStamp);\n    };\n    let draw = (now) => {\n      if (now - start >= duration) { // sliding ends\n        window.requestAnimationFrame(() => {\n          scrollTo(el, startx + distanceX, starty + distanceY);\n          if (new_height) {\n            el.style.height = `${new_height}px`;\n          }\n          updateCarousel(el);\n        });\n        resolve(el);\n        return;\n      }\n      var p = (now - start) / duration;\n      var val = inOutSine(p);\n      var x = startx + distanceX * val;\n      var y = starty + distanceY * val;\n      if (scroll_changing) {\n        scrollTo(el, x, y);\n      }\n      if (new_height) {\n        window.requestAnimationFrame(() => {\n          el.style.height = `${starth + distanceH * val}px`;\n        }); // Timeout because Safari can't do scroll and height at once\n      }\n      requestAnimationFrame(draw);\n    };\n    requestAnimationFrame(startAnim);\n  });\n  const updateCarousel = (el, forced = false) => { // Forced means never skip unnecessary update\n    // Called on init and scroll end\n    // console.log(el, el.matches(':fullscreen'));\n    if (el.togglingFullScreen) {\n      // console.log('updateCarousel: toggling Full Screen')\n      return;\n    }\n    observersOff(el);\n    let saved_x = el.dataset.x; // On displaced slides and no change\n    let saved_y = el.dataset.y;\n    el.dataset.x = Math.abs(Math.round(scrollStartX(el) / ceilingWidth(el.firstElementChild)));\n    el.dataset.y = Math.abs(Math.round(el.scrollTop / ceilingHeight(el.firstElementChild)));\n    // When inline\n    if (el.dataset.x === \"NaN\") {\n      el.dataset.x = 0;\n    }\n    if (el.dataset.y === \"NaN\") {\n      el.dataset.y = 0;\n    }\n    let active_index = getIndex(el);\n    if (active_index >= el.children.length) {\n      active_index = el.children.length - 1;\n    }\n    // console.log('update at', active_index, el.dataset.x, el.dataset.y);\n    let old_active_slide = el.querySelector(\":scope > [aria-current]\");\n    let wrapper = el.parentElement;\n    if (!isAutoHeight(wrapper)) {\n      // Dynamic change from auto height to normal\n      el.style.height = \"\";\n    }\n    let active_slide = el.children[active_index];\n    if (old_active_slide && !forced) {\n      if (active_slide === old_active_slide) {\n        // Scroll snapping back to the same slide. Nothing to do here.\n        el.dataset.x = saved_x;\n        el.dataset.y = saved_y;\n        observersOn(el);\n        return;\n      }\n      old_active_slide.removeAttribute('aria-current');\n      old_active_slide.style.height = \"\";\n      if (!isVertical(el)) {\n        el.style.height = \"\";\n      }\n    }\n    // active_slide.ariaCurrent = true; // Unsupported by FF\n    active_slide.setAttribute('aria-current', true);\n    var active_index_real = el.dataset.x = el.dataset.y = getIndexReal(el);\n    // Endless carousel\n    const restoreDisplacedSlides = el => {\n      el.querySelectorAll(\":scope > [data-first]\").forEach(el2 => {\n        el.append(el.firstElementChild);\n        delete el2.dataset.first;\n        active_index--;\n      });\n      el.querySelectorAll(\":scope > [data-last]\").forEach(el2 => {\n        el.prepend(el.lastElementChild);\n        delete el2.dataset.last;\n        active_index++;\n      });\n    }\n    wrapper.dataset.sliding = true;\n    if (isEndless(el) && !forced) {\n      if (active_index === 0) {\n        if (!active_slide.dataset.first) {\n          // Move the last one to the front as [data-first]\n          if (el.lastElementChild.dataset.last) {\n            delete el.lastElementChild.dataset.last;\n            active_index_real = 1;\n          } else {\n            el.lastElementChild.dataset.first = true;\n          }\n          el.prepend(el.lastElementChild);\n          active_index = 1;\n        } else {\n          // Landed on fake first slide. Move it to the back, remove its [data-first] and move the first one to the back as [data-last]\n          delete el.firstElementChild.dataset.first;\n          el.append(el.firstElementChild);\n          el.firstElementChild.dataset.last = true;\n          el.append(el.firstElementChild);\n          active_index_real = el.children.length - 1;\n          active_index = el.children.length - 2;\n        }\n      } else {\n        if (active_index === el.children.length - 1) {\n          if (!active_slide.dataset.last) {\n            // Move the first one to the back as [data-last]\n            if (el.firstElementChild.dataset.first) {\n              delete el.firstElementChild.dataset.first;\n              active_index_real = el.children.length - 2;\n            } else {\n              el.firstElementChild.dataset.last = true;\n            }\n            el.append(el.firstElementChild);\n            active_index = el.children.length - 2;\n          } else {\n            // Landed on fake last slide. Move it to the front, remove its [data-last] and move the last one to the front as [data-first]\n            delete el.lastElementChild.dataset.last;\n            el.prepend(el.lastElementChild);\n            el.lastElementChild.dataset.first = true;\n            el.prepend(el.lastElementChild);\n            active_index_real = 0;\n            active_index = 1;\n          }\n        } else {\n          // Middle slide\n          restoreDisplacedSlides(el);\n          active_index_real = Math.max(0, [...el.children].indexOf(el.querySelector(\":scope > [aria-current]\"))); // Fixes position when sliding to/from first slide; max because of FF returning -1\n        }\n      }\n      const updateScroll = () => {\n        el.dataset.x = el.dataset.y = active_index_real;\n        let scroll_x = ceilingWidth(el.firstElementChild) * active_index;\n        let scroll_y = ceilingHeight(el.firstElementChild) * active_index;\n        // console.log('updateCarousel() scrolling at', scroll_x);\n        el.scroll_x = scroll_x;\n        el.scroll_y = scroll_y;\n        scrollTo(el, scroll_x, scroll_y); // First element size, because when Peeking, it differs from carousel size\n        delete el.scroll_x;\n        delete el.scroll_y;\n      }\n      if (isVertical(el) && isAutoHeight(el)) {\n        window.requestAnimationFrame(() => { // Causes blinking, but needed for vertical auto height endless\n          updateScroll();\n        });\n      } else {\n        updateScroll();\n      }\n    } else { // Check and restore dynamically disabled endless option\n      restoreDisplacedSlides(el);\n      active_index_real = Math.max(0, [...el.children].indexOf(el.querySelector(\":scope > [aria-current]\"))); // Fixes position when sliding to/from first slide; max because of FF returning -1\n    }\n    active_slide.style.height = \"\";\n    wrapper.style.setProperty(\"--height\", `${isAutoHeight(el) ? nextSlideHeight(active_slide) : active_slide.scrollHeight}px`);\n    window.requestAnimationFrame(() => {\n      if (!el.parentNode.dataset.ready && isAutoHeight(el) && isVertical(el)) {\n        el.style.height = `${parseFloat(getComputedStyle(el).height) - paddingY(el)}px`;\n      }\n    });\n    // Sliding to a slide with a hash? Update the URI\n    if (getComputedStyle(el).visibility !== 'hidden') {\n      let previously_active = document.activeElement;\n      let hash = active_slide.id;\n      if (!!el.parentNode.dataset.ready && !!hash && !el.parentNode.closest('.n-carousel__content')) { // Hash works only with top-level carousel\n        location.hash = `#${hash}`;\n      }\n      if (!!el.parentNode.dataset.ready && !hash && !el.parentNode.closest('.n-carousel__content') && window.nCarouselNav) { // Hash works only with top-level carousel\n        location.hash = '';\n      }\n      previously_active.focus();\n    }\n    // Fix buttons\n    let index = getControl(el.closest(\".n-carousel\"), \".n-carousel__index\");\n    if (!!index) {\n      index.querySelector(\"[aria-current]\")?.removeAttribute('aria-current');\n      // index.children[active_index_real].ariaCurrent = true; // Unsupported by FF\n      indexControls(index)[active_index_real].setAttribute('aria-current', true);\n    }\n    // Disable focus on children of non-active slides\n    // Active slides of nested carousels should also have disabled focus\n    [...el.children].forEach(el => { // Native \"inert\" attribute to replace the below \"focusDisabled\" loops from June 2022. \n      el.inert = (el === active_slide) ? false : true;\n      if (isSafari && el.querySelector('.n-carousel:-webkit-full-screen')) {\n        // Safari full screen bug: parent scroll resets to 0, first slide becomes active and the full screen child lightbox is inside an inert parent\n        let current = el.parentNode.querySelector(':scope > [aria-current=\"true\"]');\n        current.inert = true;\n        current.removeAttribute('aria-current');\n        el.inert = false;\n        el.setAttribute('aria-current', true);\n      }\n    });\n    // Obsoleted by inert – start\n    // [...el.children].forEach((slide) => {\n    //   if (slide !== active_slide) {\n    //     slide.setAttribute('aria-hidden', true);\n    //     slide.querySelectorAll(focusableElements).forEach((el2) => {\n    //       if (el2.closest(\".n-carousel__content > :not([aria-current])\")) {\n    //         if (el2.getAttribute(\"tabindex\") && !el2.dataset.focusDisabled) {\n    //           el2.dataset.oldTabIndex = el2.tabIndex;\n    //         }\n    //         el2.dataset.focusDisabled = true;\n    //         el2.tabIndex = -1;\n    //       }\n    //     });\n    //   }\n    // });\n    // active_slide.removeAttribute('aria-hidden');\n    // active_slide.querySelectorAll(\"[data-focus-disabled]\").forEach((el2) => {\n    //   if (!el2.closest(\".n-carousel__content > :not([aria-current])\")) {\n    //     el2.removeAttribute(\"tabindex\");\n    //     delete el2.dataset.focusDisabled;\n    //     if (!!el2.dataset.oldTabIndex) {\n    //       el2.tabIndex = el2.dataset.oldTabIndex;\n    //       delete el2.dataset.oldTabIndex;\n    //     }\n    //   }\n    // });\n    // Obsoleted by inert – end\n    if (/--vertical.*--auto-height/.test(wrapper.classList)) { // Undo jump to wrong slide when sliding to the last one\n      el.scrollTop = el.offsetHeight * active_index_real;\n    }\n    window.requestAnimationFrame(() => {\n      observersOn(el);\n    });\n  };\n  const slide = (el, offsetX = 0, offsetY = 0, index) => {\n    clearTimeout(el.nCarouselTimeout);\n    if (!el.parentNode.dataset.sliding) {\n      el.parentNode.dataset.sliding = true;\n      let old_height = el.children[getIndexReal(el)].offsetHeight;\n      let new_height = old_height;\n      if (isAutoHeight(el)) {\n        let old_scroll_left = scrollStartX(el);\n        let old_scroll_top = el.scrollTop;\n        let slide = el.children[index];\n        if (isVertical(el)) {\n          slide.style.height = 'auto';\n          let computed_max_height = getComputedStyle(el).maxHeight;\n          let max_height = computed_max_height.match(/px/) ? Math.ceil(parseFloat(computed_max_height)) : 99999;\n          // new_height = Math.min(slide.scrollHeight, max_height);\n          new_height = Math.min(Math.ceil(parseFloat(getComputedStyle(slide).height)), max_height);\n          // new_height = slide.scrollHeight;\n          slide.style.height = '';\n        } else {\n          new_height = nextSlideHeight(slide);\n          let old_height = getIndexReal(el) === index ? new_height : nextSlideHeight(el.children[getIndexReal(el)]);\n          el.parentNode.style.setProperty(\"--height\", `${old_height}px`);\n        }\n        scrollTo(el, old_scroll_left + paddingX(el) / 2, old_scroll_top); // iPad bug\n        scrollTo(el, old_scroll_left, old_scroll_top);\n      }\n      if (isVertical(el)) {\n        if ((isModal(el) || isFullScreen()) && isAutoHeight(el)) {\n          old_height = new_height = el.offsetHeight;\n        }\n        offsetY = offsetY - index * old_height + index * new_height;\n      }\n      // console.log(index, offsetX, offsetY);\n      window.requestAnimationFrame(() => {\n        if (!el.parentNode.dataset.duration && !isAutoHeight(el)) { // Unspecified duration, no height change – using native smooth scroll\n          delete el.parentNode.dataset.sliding;\n          el.dataset.next = index;\n          el.scrollTo({\n            top: el.scrollTop + offsetY,\n            left: el.scrollLeft + offsetX,\n            behavior: window.matchMedia('(prefers-reduced-motion: reduce)').matches ? \"auto\" : \"smooth\"\n          });\n        } else {\n          scrollAnimate(el, offsetX, offsetY, new_height === old_height ? false : new_height, old_height); // Vertical version will need ceiling value\n        }\n      });\n    }\n  };\n  const slideNext = el => {\n    let index = getIndexReal(el);\n    slideTo(el, index >= el.children.length - 1 ? 0 : index + 1);\n  };\n  const slidePrevious = el => {\n    let index = getIndexReal(el);\n    slideTo(el, index === 0 ? el.children.length - 1 : index - 1);\n  };\n  const slideTo = (el, index) => {\n    if (isVertical(el)) {\n      slide(el, 0, ceilingHeight(el.children[index]) * index - el.scrollTop, index);\n    } else {\n      let width = Math.ceil(parseFloat(getComputedStyle(el.children[index]).width));\n      let new_offset = isRTL(el) ? Math.abs(scrollStartX(el)) - width * index : width * index - scrollStartX(el);\n      slide(el, new_offset, 0, index);\n    }\n  };\n  const carouselKeys = e => {\n    // console.log('keydown', e);\n    // return;\n    let keys = [\"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"ArrowDown\", \"PageUp\", \"PageDown\", \"Home\", \"End\"];\n    let el = e.target.closest('.n-carousel').querySelector(':scope > .n-carousel__content');\n    // if (e.key === \"Tab\") {\n    //   let carousel = el.closest(\".n-carousel__content\");\n    //   carousel.tabbing = true;\n    // }\n    if (\n      // el.matches(\".n-carousel__content\") && \n      keys.includes(e.key)) {\n      // Capture relevant keys\n      // e.preventDefault();\n      switch (e.key) {\n        case \"ArrowLeft\": {\n          isRTL(el) ? slideNext(el) : slidePrevious(el);\n          break;\n        }\n        case \"ArrowRight\": {\n          isRTL(el) ? slidePrevious(el) : slideNext(el);\n          break;\n        }\n        case \"ArrowUp\":\n        case \"PageUp\": {\n          slidePrevious(el);\n          break;\n        }\n        case \"ArrowDown\":\n        case \"PageDown\": {\n          slideNext(el);\n          break;\n        }\n        case \"Home\": {\n          slideTo(el, 0);\n          break;\n        }\n        case \"End\": {\n          slideTo(el, el.children.length - 1);\n          break;\n        }\n      }\n    }\n  };\n  const slidePreviousEvent = e => slidePrevious(closestCarousel(e.target.closest('[class*=\"n-carousel\"]')));\n  const slideNextEvent = e => slideNext(closestCarousel(e.target.closest('[class*=\"n-carousel\"]')));\n  const slideIndexEvent = e => {\n    let el = e.target.closest(\"a, button\");\n    if (el && !(el.href && (e.ctrlKey || e.metaKey))) {\n      const wrapper = document.querySelector(`.n-carousel#${el.parentNode.dataset.for}`) || el.closest(\".n-carousel\");\n      const carousel = wrapper.querySelector(\":scope > .n-carousel__content\");\n      let new_index = [...indexControls(el.parentNode)].indexOf(el);\n      if (isEndless(carousel)) {\n        var old_index = getIndex(carousel);\n        if (old_index === 0) {\n          if (new_index === carousel.children.length - 1) {\n            new_index = 0;\n          } else {\n            new_index++;\n          }\n        }\n        if (old_index === carousel.children.length - 1) {\n          if (new_index === 0) {\n            new_index = carousel.children.length - 1;\n          } else {\n            new_index--;\n          }\n        }\n      }\n      if (wrapper.classList.contains(\"n-carousel--inline\") && !isModal(carousel)) { // Opening an inline carousel\n        wrapper.nextSlideInstant = true;\n        // wrapper.classList.add(\"n-carousel--overlay\"); // Should trigger mutation and auto update?\n        openModal(carousel);\n        // Set new x, y\n        window.requestAnimationFrame(() => {\n          carousel.dataset.x = carousel.dataset.y = new_index;\n          scrollTo(carousel, carousel.offsetWidth * carousel.dataset.x, carousel.offsetHeight * carousel.dataset.y);\n          document.body.dataset.frozen = document.body.scrollTop;\n          updateCarousel(carousel);\n        });\n      } else {\n        window.requestAnimationFrame(() => {\n          slideTo(carousel, new_index);\n        });\n      }\n      return false;\n    }\n  };\n  const closeModalOnBodyClick = e => {\n    let overlay = document.querySelector('.n-carousel--overlay');\n    if (overlay && e.key === 'Escape') {\n      closeModal(overlay);\n    }\n  };\n  const closeModal = el => {\n    if (isFullScreen()) {\n      !!document.exitFullscreen ? document.exitFullscreen() : document.webkitExitFullscreen();\n    }\n    let carousel = closestCarousel(el);\n    if (carousel) {\n      carousel.parentNode.toggleModal = true; // skip mutation observer\n      carousel.closest(\".n-carousel\").classList.remove(\"n-carousel--overlay\");\n      trapFocus(carousel.closest(\".n-carousel\"), true); // Disable focus trap\n      delete document.body.dataset.frozen;\n    }\n    document.body.removeEventListener('keyup', closeModalOnBodyClick);\n  };\n  const openModal = el => {\n    let carousel = closestCarousel(el);\n    if (carousel) {\n      carousel.parentNode.toggleModal = true; // skip mutation observer\n      carousel.closest(\".n-carousel\").classList.add(\"n-carousel--overlay\");\n      trapFocus(carousel.closest(\".n-carousel\"));\n      setTimeout(() => { document.body.addEventListener('keyup', closeModalOnBodyClick); }, 100);\n    }\n  };\n  const autoHeightObserver = new ResizeObserver((entries) => {\n    window.requestAnimationFrame(() => {\n      entries.forEach(e => {\n        let slide = e.target.querySelector(\":scope > [aria-current]\");\n        let el = slide.closest(\".n-carousel__content\");\n        if (!el.parentElement.dataset.sliding) {\n          // console.log(e.target);\n          el.parentNode.style.removeProperty('--height');\n          if (isVertical(el)) {\n            slide.style.height = 'auto';\n            el.style.height = `${slide.scrollHeight}px`;\n            slide.style.height = '';\n            updateCarousel(el);\n          } else {\n            el.style.height = '';\n            el.style.height = `${slide.scrollHeight}px`;\n            updateCarousel(el, true);\n          }\n        }\n      });\n    });\n  });\n  const updateSubpixels = el => {\n    if (!el.parentNode.dataset.sliding) {\n      // Round down the padding, because sub pixel padding + scrolling is a problem\n      let carousel = el;\n      carousel.style.padding = ''; // Subpixel peeking fix\n      carousel.style.removeProperty(\"--peek-int\");\n      carousel.style.padding = isVertical(carousel) ? `${parseInt(getComputedStyle(carousel).paddingBlockStart)}px 0` : `0 ${parseInt(getComputedStyle(carousel).paddingInlineStart)}px`;\n      if (carousel.style.padding === '0px') {\n        carousel.style.padding = '';\n      } else {\n        // For Safari, which doesn't support inline end padding in a scrollable container\n        carousel.style.setProperty(\"--peek-int\", isVertical(carousel) ? `${parseInt(getComputedStyle(carousel).paddingBlockStart)}px 0 0 0` : `0 ${parseInt(getComputedStyle(carousel).paddingInlineStart)}px 0 0`);\n      }\n      window.requestAnimationFrame(() => {\n        if (isVertical(el)) {\n          carousel.style.setProperty(\"--subpixel-compensation\", Math.ceil(carousel.getBoundingClientRect().height) - carousel.getBoundingClientRect().height);\n        } else {\n          carousel.style.setProperty(\"--subpixel-compensation\", Math.ceil(carousel.getBoundingClientRect().width) - carousel.getBoundingClientRect().width);\n        }\n        let offset = getIndexReal(carousel); // Real offset including displaced first/last slides\n        scrollTo(carousel, offset * ceilingWidth(carousel.firstElementChild), offset * ceilingHeight(carousel.firstElementChild));\n      });\n    }\n  };\n  const observersOn = el => {\n    window.requestAnimationFrame(() => {\n      if (el.scroll_x && el.scroll_y) {\n        scrollTo(el, el.scroll_x, el.scroll_y);\n      }\n      if (el.parentNode.matches(\".n-carousel--vertical.n-carousel--controls-outside.n-carousel--auto-height\")) {\n        height_minus_index.observe(el.parentNode);\n      } else {\n        height_minus_index.unobserve(el.parentNode);\n      }\n      subpixel_observer.observe(el);\n      mutation_observer.observe(el.parentNode, {\n        attributes: true,\n        attributeFilter: [\"class\"],\n      });\n      el.addEventListener('scrollend', scrollEndAction);\n      // setTimeout(() => {\n      delete el.parentNode.dataset.sliding;\n      // }, 50); // Because intersection observer fires again\n      if (!(\"onscrollend\" in window) && isEndless(el)) { // Fix for browsers without scrollend event (Safari) losing parts of the edge slide\n        scrollTo(el, el.offsetWidth * getIndexReal(el), el.offsetHeight * getIndexReal(el));\n      }\n    });\n  };\n  const observersOff = el => {\n    height_minus_index.unobserve(el.parentNode);\n    subpixel_observer.unobserve(el);\n    el.observerStarted = true;\n    el.removeEventListener('scrollend', scrollEndAction);\n  };\n  const updateObserver = el => {\n    observersOff(el);\n    const doUpdate = el => {\n      updateSubpixels(el);\n      window.requestAnimationFrame(() => {\n        let current_height = el.querySelector(\":scope > [aria-current]\").scrollHeight + \"px\";\n        let previous_height = getComputedStyle(el).getPropertyValue(\"--height\");\n        if (current_height !== previous_height) {\n          el.parentNode.style.setProperty(\"--height\", current_height);\n        }\n        observersOn(el);\n      });\n    };\n    doUpdate(el);\n    el.querySelectorAll('.n-carousel__content').forEach(el => doUpdate(el));\n  };\n  const subpixel_observer = new ResizeObserver((entries) => {\n    window.requestAnimationFrame(() => {\n      entries.forEach(e => {\n        let el = e.target;\n        if (!!el.observerStarted) {\n          el.observerStarted = false;\n          return;\n        }\n        updateObserver(el);\n      });\n    });\n  });\n  const mutation_observer = new MutationObserver((mutations) => {\n    for (let mutation of mutations) {\n      if (mutation.target && !mutation.target.nextSlideInstant && !mutation.target.toggleModal) {\n        let carousel = mutation.target.querySelector(\":scope > .n-carousel__content\");\n        updateObserver(carousel);\n        updateCarousel(carousel, true);\n        delete mutation.target.toggleModal;\n      }\n    }\n  });\n  const setIndexWidth = el => {\n    let index = el.querySelector(\":scope > .n-carousel__index\");\n    if (index && !el.dataset.sliding) {\n      el.style.removeProperty(\"--height-minus-index\");\n      index.style.position = \"absolute\";\n      el.style.setProperty(\"--height-minus-index\", `${el.offsetHeight}px`);\n      el.style.setProperty(\"--index-width\", getComputedStyle(el.querySelector(\":scope > .n-carousel__index\")).width);\n      index.style.position = \"\";\n    }\n  };\n  const height_minus_index = new ResizeObserver((entries) => {\n    // Limit outside index height to carousel height\n    window.requestAnimationFrame(() => {\n      // Observing the carousel wrapper\n      entries.forEach(e => {\n        let el = e.target;\n        setIndexWidth(el);\n      });\n    });\n  });\n  const init = (host = document) => {\n    host.querySelectorAll(\".n-carousel:not([data-ready])\").forEach(el => {\n      const previous = getControl(el, \".n-carousel__previous\");\n      const next = getControl(el, \".n-carousel__next\");\n      const index = getControl(el, \".n-carousel__index\");\n      const close_modal = getControl(el, \".n-carousel__close\");\n      const full_screen = getControl(el, \".n-carousel__full-screen\");\n      const content = el.querySelector(\":scope > .n-carousel__content\");\n      if (!content) {\n        return;\n      }\n      if (!!previous) {\n        previous.onclick = slidePreviousEvent;\n      }\n      if (!!next) {\n        next.onclick = slideNextEvent;\n      }\n      if (!!index) {\n        index.onclick = slideIndexEvent;\n      }\n      if (!!close_modal) {\n        close_modal.onclick = e => {\n          if (e.target.closest('.n-carousel').classList.contains('n-carousel--overlay')) {\n            closeModal(e.target);\n          } else {\n            openModal(e.target);\n          }\n        }\n      }\n      if (!!full_screen) {\n        full_screen.onclick = e => {\n          let carousel = e.target.closest(\".n-carousel\").querySelector(\":scope > .n-carousel__content\");\n          carousel.dataset.xx = carousel.dataset.x;\n          carousel.dataset.yy = carousel.dataset.y;\n          toggleFullScreen(e.target);\n        };\n        const fullScreenEvent = e => {\n          // console.log(e, 'full screen');\n          let carousel = e.target.querySelector(\":scope > .n-carousel__content\");\n          window.requestAnimationFrame(() => {\n            carousel.dataset.x = carousel.dataset.xx;\n            carousel.dataset.y = carousel.dataset.yy;\n            delete carousel.dataset.xx;\n            delete carousel.dataset.yy;\n            if (carousel.dataset.x !== \"undefined\" && carousel.dataset.y !== \"undefined\") {\n              scrollTo(carousel, getIndexReal(carousel) * ceilingWidth(carousel.children[getIndexReal(carousel)]), getIndexReal(carousel) * ceilingHeight(carousel.children[getIndexReal(carousel)]));\n            }\n            // setTimeout(() => {\n              delete carousel.togglingFullScreen;\n              updateCarousel(carousel);\n            // }, 100);\n          });\n        };\n        if (isSafari) {\n          el.onwebkitfullscreenchange = fullScreenEvent;\n        } else {\n          el.onfullscreenchange = fullScreenEvent;\n        }\n      }\n      el.addEventListener(\"keydown\", carouselKeys);\n      el.addEventListener(\"keyup\", e => {\n        if (e.key === \"Escape\") {\n          let el = e.target;\n          if (!el.closest('.n-carousel--overlay')) {\n            el = document.querySelector('.n-carousel--overlay');\n          }\n          if (el) {\n            closeModal(el);\n          }\n        }\n      });\n      updateSubpixels(content);\n      content.observerStarted = true;\n      let hashed_slide = !!location.hash ? content.querySelector(\":scope > \" + location.hash) : false;\n      if (hashed_slide) {\n        if (el.classList.contains('n-carousel--inline')) {\n          openModal(content);\n          // el.classList.add('n-carousel--overlay');\n        }\n        let index = [...hashed_slide.parentNode.children].indexOf(hashed_slide);\n        if (isVertical(content)) {\n          content.dataset.y = index;\n        } else {\n          content.dataset.x = index;\n        }\n        // slideTo(content, index); // This slides to the wrong slide\n        window.nCarouselNav = [content, location.hash];\n      }\n      if (el.matches(\".n-carousel--vertical.n-carousel--auto-height\")) {\n        content.style.height = '';\n        content.style.height = getComputedStyle(content).height;\n        el.dataset.ready = true;\n        content.scrollTop = 0; // Should be a different value if the initial active slide is other than the first one (unless updateCarousel() takes care of it)\n      }\n      if (isAutoHeight(el)) {\n        // Auto has a specified height which needs update on resize\n        autoHeightObserver.observe(content);\n      }\n      window.requestAnimationFrame(() => {\n        observersOn(content);\n        if (el.parentNode.matches(\".n-carousel--vertical.n-carousel--controls-outside.n-carousel--auto-height\")) {\n          setIndexWidth(el);\n        }\n        updateCarousel(content);\n        el.dataset.ready = true;\n        if (el.matches(\".n-carousel--auto-slide\")) {\n          let auto_delay = (parseFloat(el.dataset.interval) * 1000 || default_interval) + (parseFloat(el.dataset.duration) * 1000 || default_duration);\n          let carouselTimeout = () => {\n            if (isElementInViewport(content)) {\n              slideNext(content);\n            }\n            content.nCarouselTimeout = setTimeout(carouselTimeout, auto_delay);\n          };\n          content.nCarouselTimeout = setTimeout(carouselTimeout, parseFloat(el.dataset.interval) * 1000 || default_interval);\n          content.addEventListener(\"pointerenter\", e => clearTimeout(e.target.nCarouselTimeout));\n        }\n        el.dataset.platform = navigator.platform; // iPhone doesn't support full screen, Windows scroll works differently\n      });\n      content.nCarouselUpdate = updateCarousel;\n      // below replaced by scrollend polyfill\n      // if (!(\"onscrollend\" in window)) { // scrollend event fallback to intersection observer (for Safari as of 2023)\n      //   const scrollEndObserver = new IntersectionObserver(entries => {\n      //     let carousel = entries[0].target.parentNode;\n      //     if (entries[0].isIntersecting && !carousel.parentNode.dataset.sliding && getComputedStyle(carousel).visibility !== 'hidden') {\n      //       scrollEndAction(carousel);\n      //     }\n      //   }, { threshold: .996, root: el.parentElement }); // .99 works for all, including vertical auto height?\n      //   [...content.children].forEach(el => scrollEndObserver.observe(el));\n      // }\n      if (el.matches('.n-carousel--lightbox')) {\n        let loaded = img => {\n          img.closest('picture').dataset.loaded = true;\n        };\n        content.querySelectorAll(\"picture img\").forEach(el => {\n          if (el.complete) {\n            loaded(el);\n          } else {\n            el.addEventListener(\"load\", e => {\n              loaded(e.target);\n            });\n          }\n        });\n      }\n    });\n  };\n  window.nCarouselInit = init;\n  window.addEventListener('popstate', hashNavigation);\n  const doInit = () => {\n    (typeof nui !== 'undefined' && typeof nui.registerComponent === \"function\") ? nui.registerComponent(\"n-carousel\", init): init();\n  };\n  if (document.readyState !== \"loading\") {\n    doInit();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", doInit);\n  }\n})();"]}